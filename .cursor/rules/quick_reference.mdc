---
alwaysApply: true
---

# AgentFlow è¦ç¯„ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

> ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 2.1.0 | æ›´æ–°: 2026-01-13

---

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

| é …ç›® | å€¤ |
|------|-----|
| è¨€èª | Python 3.13+ |
| Linter | Ruff (line-length=100) |
| å‹ | Mypy (strict) |
| ãƒ†ã‚¹ãƒˆ | Pytest (covâ‰¥80%) |
| ãƒ—ãƒ­ãƒˆã‚³ãƒ« | MCP/A2A/AG-UI/A2UI/WebSocket |

---

## ğŸ“ ä¸»è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

```
agentflow/
â”œâ”€â”€ core/           # AgentBlock, Registry, ErrorResponse
â”œâ”€â”€ patterns/       # DeepAgent, Reflection, Pipeline, Reflexion
â”œâ”€â”€ services/       # AgentService, WorkflowService (çµ±ä¸€ã‚µãƒ¼ãƒ“ã‚¹å±¤)
â”œâ”€â”€ providers/      # LLM, ToolExecutor
â”œâ”€â”€ protocols/      # MCP, A2A, AG-UI, A2UI
â”œâ”€â”€ integrations/   # WebSocket, SSE, FastAPI
â”œâ”€â”€ memory/         # LightMem, VectorStore
â”œâ”€â”€ engines/        # SimpleEngine, PipelineEngine, RAGEngine
â””â”€â”€ skills/         # Skillsè‡ªå‹•é€²åŒ–
```

---

## ğŸš€ ä¸»è¦ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ3+1ï¼‰

### 1. DeepAgentï¼ˆæ¨å¥¨ï¼‰- è¤‡é›‘ãªãƒãƒ«ãƒAgentå”èª¿
```python
from agentflow.patterns import DeepAgentCoordinator

coordinator = DeepAgentCoordinator(
    llm_client=llm,
    max_iterations=10,
    quality_threshold=75.0,
)
result = await coordinator.execute("ã‚¿ã‚¹ã‚¯")
```

### 2. Reflection - è‡ªå·±æ”¹å–„ãƒ«ãƒ¼ãƒ—
```python
from agentflow.patterns import ReflectionWorkflow

workflow = ReflectionWorkflow(llm_client=llm, max_iterations=3)
result = await workflow.run({"task": "..."})
```

### 3. Pipeline - é †æ¬¡å®Ÿè¡Œ
```python
from agentflow.patterns import AgentPipeline

pipeline = AgentPipeline(agents=[Agent1(), Agent2()])
result = await pipeline.run(input_data)
```

### 4. Reflexion - å¤±æ•—å­¦ç¿’
```python
from agentflow.patterns import ReflectiveEvolver

evolver = ReflectiveEvolver(llm_client=llm)
await evolver.learn_from_failure(task, error, context)
```

---

## ğŸ”§ åŸºæœ¬æ“ä½œ

### Agentå®šç¾©
```python
from agentflow.core.agent_block import AgentBlock

class MyAgent(AgentBlock):
    async def run(self, input_data: dict) -> dict:
        return {"result": "ok"}
```

### LLMå‘¼ã³å‡ºã—
```python
from agentflow.providers import get_llm

llm = get_llm()
response = await llm.chat([{"role": "user", "content": "..."}])
```

### ã‚µãƒ¼ãƒ“ã‚¹å±¤ï¼ˆAPI/CLI/Studioçµ±ä¸€ï¼‰
```python
from agentflow.services import AgentService

service = AgentService()

# APIå‘ã‘
result = await service.execute(agent_id="MyAgent")

# CLIå‘ã‘
result = await service.execute_with_callback(on_progress=lambda p,m: print(f"[{p}%] {m}"))

# Studioå‘ã‘
async for event in service.execute_stream():
    await ws.send(event.to_json())
```

---

## ğŸŒ ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆ5ã¤ï¼‰

| ãƒ—ãƒ­ãƒˆã‚³ãƒ« | ç”¨é€” | ã‚¯ãƒ©ã‚¹ |
|-----------|------|--------|
| MCP | ãƒ„ãƒ¼ãƒ«æ¥ç¶š | `MCPClient` |
| A2A | Agenté–“é€šä¿¡ | `A2AClient` |
| AG-UI | SSEã‚¤ãƒ™ãƒ³ãƒˆ | `AGUIEventEmitter` |
| A2UI | ç”Ÿæˆå¼UI | `A2UIEmitter` |
| WebSocket | åŒæ–¹å‘/HITL | `WebSocketManager` |

---

## ğŸ“¦ é‡è¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```python
# ãƒ‘ã‚¿ãƒ¼ãƒ³
from agentflow.patterns import (
    DeepAgentCoordinator,
    ReflectionWorkflow,
    AgentPipeline,
    ReflectiveEvolver,
)

# ã‚µãƒ¼ãƒ“ã‚¹å±¤
from agentflow.services import AgentService, WorkflowService

# ã‚³ã‚¢
from agentflow.core.agent_block import AgentBlock
from agentflow.core import ErrorResponse, ErrorCode

# ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
from agentflow.providers import get_llm, ToolExecutor

# ãƒ¡ãƒ¢ãƒª
from agentflow.memory import MemoryManager, VectorStore

# ãƒ—ãƒ­ãƒˆã‚³ãƒ«
from agentflow.protocols import MCPClient, A2AClient
from agentflow.integrations import WebSocketManager
```

---

## âŒ ç¦æ­¢äº‹é …

| âŒ | âœ… |
|----|-----|
| `print()` | `logging` |
| `Any` å‹ | å…·ä½“å‹ |
| `except Exception` | ç‰¹å®šä¾‹å¤– |
| `def foo(x=[])` | `x: list | None = None` |
| ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ | ç’°å¢ƒå¤‰æ•° |
| `--no-verify` | ç¦æ­¢ |

---

## âœ… ã‚³ãƒŸãƒƒãƒˆå‰

```bash
ruff format . && ruff check . && mypy . && pytest
```

---

## ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ„ãƒ¼ãƒ« | è¨­å®š |
|--------|------|
| Ruff | line-length=100, py313 |
| Mypy | strict=true |
| Pytest | asyncio_mode=auto, covâ‰¥80% |

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- `docs/PATTERNS_GUIDE.md` - ãƒ‘ã‚¿ãƒ¼ãƒ³è©³ç´°
- `docs/protocols.md` - ãƒ—ãƒ­ãƒˆã‚³ãƒ«è©³ç´°
- `docs/api.md` - API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹
- `docs/architecture.md` - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
