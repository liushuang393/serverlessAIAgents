# -*- coding: utf-8 -*-
# Fullstack App テンプレート定義
# AI 助手が新規 App 構築時に使用する標準基盤テンプレート

id: fullstack-app
name: Fullstack App Template
description: |
  FastAPI + PostgreSQL + Redis + Alembic + React の完全な App 基盤テンプレート。
  DB マイグレーション、設定管理、API ルーティング、リポジトリパターン、テスト構造を含む。
category: fullstack
author: agentflow-team
version: "1.0.0"

# カスタマイズパラメーター
parameters:
  - name: app_name
    type: string
    description: アプリケーション名（snake_case 推奨）
    required: true
    
  - name: app_title
    type: string
    description: 表示用タイトル（日本語可）
    required: true
    
  - name: app_description
    type: string
    description: アプリケーション説明
    default: "AgentFlow App"
    
  - name: db_name
    type: string
    description: PostgreSQL データベース名
    required: true
    
  - name: db_user
    type: string
    description: PostgreSQL ユーザー名
    default: "app_user"
    
  - name: db_password
    type: string
    description: PostgreSQL パスワード
    default: "app_password"
    
  - name: redis_enabled
    type: bool
    description: Redis キャッシュを有効化
    default: true
    
  - name: frontend_enabled
    type: bool
    description: React フロントエンドを有効化
    default: true
    
  - name: use_history_db
    type: bool
    description: 履歴用の第2 PostgreSQL を有効化
    default: false
    
  - name: api_port
    type: int
    description: API サーバーポート
    default: 8000
    
  - name: db_port
    type: int
    description: PostgreSQL ポート
    default: 5432

# 生成されるファイル構造
structure:
  - docker-compose.yml         # コンテナ構成
  - Dockerfile                 # API コンテナ
  - alembic.ini               # DB マイグレーション設定
  - requirements.txt          # Python 依存パッケージ
  - api.py                    # FastAPI エントリポイント
  - config/__init__.py        # 設定読み込み
  - config/settings.yaml      # アプリ設定
  - db/init/01_schema.sql     # 初期スキーマ
  - migrations/env.py         # Alembic 環境
  - migrations/versions/      # マイグレーションファイル
  - repositories/__init__.py  # リポジトリ層
  - repositories/database.py  # DB 接続
  - repositories/models.py    # SQLAlchemy モデル
  - routers/__init__.py       # API ルーター
  - services/__init__.py      # ビジネスロジック
  - schemas/__init__.py       # Pydantic スキーマ
  - tests/unit/               # 単体テスト
  - frontend/                 # React アプリ（オプション）

# 技術スタック
tech_stack:
  backend:
    - FastAPI >= 0.100.0
    - SQLAlchemy >= 2.0
    - asyncpg >= 0.29
    - alembic >= 1.13
    - pydantic >= 2.0
    - redis >= 5.0
  database:
    - PostgreSQL 16
    - Redis 7
  frontend:
    - React 18
    - TypeScript 5
    - Tailwind CSS
  tools:
    - Docker Compose
    - Alembic (DB migration)

