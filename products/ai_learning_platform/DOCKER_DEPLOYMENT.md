# AIå­¦ç¿’ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  Dockerå±•é–‹ã‚¬ã‚¤ãƒ‰

## ğŸ“‹ æ¦‚è¦

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€AIå­¦ç¿’ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’Dockerã‚’ä½¿ç”¨ã—ã¦å±•é–‹ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ› ï¸ å‰ææ¡ä»¶

- **Docker**: 20.10ä»¥ä¸Š
- **Docker Compose**: 2.0ä»¥ä¸Š
- **Git**: æœ€æ–°ç‰ˆ

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
ai_learning_platform/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ Dockerfile          # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠè¨­å®š
â”‚   â”œâ”€â”€ requirements.txt    # Pythonä¾å­˜é–¢ä¿‚
â”‚   â””â”€â”€ app/               # FastAPIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ Dockerfile          # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠè¨­å®š
â”‚   â”œâ”€â”€ package.json       # Node.jsä¾å­˜é–¢ä¿‚
â”‚   â””â”€â”€ src/               # Reactã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ docker-compose.yml      # Docker Composeè¨­å®š
â”œâ”€â”€ nginx.conf             # Nginxãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·è¨­å®š
â”œâ”€â”€ mysql_init_db.sql      # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ docker_test.py         # Dockerè¨­å®šæ¤œè¨¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

## ğŸš€ å±•é–‹æ‰‹é †

### 1. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

```bash
# OpenAI APIã‚­ãƒ¼ã‚’è¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
export OPENAI_API_KEY=your-openai-api-key-here
```

### 2. Dockerè¨­å®šã®æ¤œè¨¼

```bash
# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯
python docker_test.py
```

### 3. ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ“ãƒ«ãƒ‰ã¨èµ·å‹•

```bash
# ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•
docker compose up --build -d
```

### 4. èµ·å‹•çŠ¶æ³ã®ç¢ºèª

```bash
# ã‚³ãƒ³ãƒ†ãƒŠã®çŠ¶æ…‹ã‚’ç¢ºèª
docker compose ps

# ãƒ­ã‚°ã‚’ç¢ºèª
docker compose logs -f
```

### 5. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: http://localhost:3000
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API**: http://localhost:8000
- **APIæ–‡æ›¸**: http://localhost:8000/docs
- **Nginx (ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·)**: http://localhost:80

## ğŸ”§ ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆ

### Backend (FastAPI)
- **ãƒãƒ¼ãƒˆ**: 8000
- **æŠ€è¡“**: Python 3.9, FastAPI, SQLAlchemy
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: MySQL 8.0

### Frontend (React)
- **ãƒãƒ¼ãƒˆ**: 3000 (å†…éƒ¨ã¯80)
- **æŠ€è¡“**: React 18, Material-UI, Nginx
- **ãƒ“ãƒ«ãƒ‰**: ãƒãƒ«ãƒã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰

### Database (MySQL)
- **ãƒãƒ¼ãƒˆ**: 3306
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: MySQL 8.0
- **åˆæœŸåŒ–**: mysql_init_db.sqlã§è‡ªå‹•å®Ÿè¡Œ

### Nginx (ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·)
- **ãƒãƒ¼ãƒˆ**: 80
- **æ©Ÿèƒ½**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒ—ãƒ­ã‚­ã‚·

## ğŸ›‘ åœæ­¢ã¨å‰Šé™¤

```bash
# ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢
docker compose down

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚‚å‰Šé™¤ã™ã‚‹å ´åˆ
docker compose down -v

# ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚‚å‰Šé™¤ã™ã‚‹å ´åˆ
docker compose down --rmi all -v
```

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒãƒ¼ãƒˆç«¶åˆã‚¨ãƒ©ãƒ¼
```bash
# ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆã‚’ç¢ºèª
netstat -tulpn | grep :8000

# ã¾ãŸã¯
lsof -i :8000
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’ç¢ºèª
docker compose logs db

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ç›´æ¥æ¥ç¶šã—ã¦ãƒ†ã‚¹ãƒˆ
docker compose exec db mysql -u ai_user -p ai_learning
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼
```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’ç¢ºèª
docker compose logs frontend

# æ‰‹å‹•ã§ãƒ“ãƒ«ãƒ‰ã‚’ãƒ†ã‚¹ãƒˆ
docker compose exec frontend npm run build
```

## ğŸ“Š ç›£è¦–ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

### ãƒ­ã‚°ã®ç¢ºèª
```bash
# å…¨ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°
docker compose logs -f

# ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°
docker compose logs -f backend
docker compose logs -f frontend
docker compose logs -f db
```

### ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ã®ç¢ºèª
```bash
# ã‚³ãƒ³ãƒ†ãƒŠã®ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡
docker stats

# ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡
docker system df
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
docker compose exec db mysqldump -u ai_user -p ai_learning > backup.sql

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©å…ƒ
docker compose exec -T db mysql -u ai_user -p ai_learning < backup.sql
```
Render/Vercel/Heroku
## ğŸŒ éƒ¨ç½²å¹³å°é¸æŠï¼šRender

æ¨å¥¨ã™ã‚‹å±•é–‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¯ **Render** ã§ã™ã€‚ç†ç”±ï¼š

- âœ… **ç„¡æ–™ãƒ—ãƒ©ãƒ³å¯¾å¿œ**: é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒã«æœ€é©
- âœ… **Dockerå±•é–‹ã‚µãƒãƒ¼ãƒˆ**: æ—¢å­˜ã®Dockerè¨­å®šã‚’ãã®ã¾ã¾åˆ©ç”¨å¯èƒ½
- âœ… **è‡ªå‹•åŒ–CI/CD**: GitHubã¨é€£æºã—ãŸè‡ªå‹•å±•é–‹
- âœ… **ç„¡æ–™SSLè¨¼æ˜æ›¸**: HTTPSå¯¾å¿œãŒè‡ªå‹•ã§è¨­å®šã•ã‚Œã‚‹
- âœ… **ç°¡å˜ãªè¨­å®š**: è¤‡é›‘ãªè¨­å®šä¸è¦ã§è¿…é€Ÿãªå±•é–‹ãŒå¯èƒ½

### Renderã§ã®å±•é–‹æ‰‹é †

#### 1. Renderã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆ
1. [Render](https://render.com) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. GitHubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—
3. ãƒªãƒã‚¸ãƒˆãƒªã‚’æ¥ç¶š

#### 2. Web Serviceã®ä½œæˆï¼ˆBackendï¼‰
1. Dashboard â†’ "New" â†’ "Web Service"
2. GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’é¸æŠ
3. è¨­å®šé …ç›®ï¼š
   ```
   Name: ai-learning-platform-backend
   Environment: Docker
   Build Command: (ç©ºç™½)
   Start Command: (ç©ºç™½) # Dockerfileã§æŒ‡å®šæ¸ˆã¿
   ```
4. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šï¼š
   ```
   DATABASE_URL=postgresql://username:password@hostname:port/database
   SECRET_KEY=your-production-secret-key
   OPENAI_API_KEY=your-openai-api-key
   ```

#### 3. PostgreSQL Databaseã®ä½œæˆ
1. Dashboard â†’ "New" â†’ "PostgreSQL"
2. è¨­å®šé …ç›®ï¼š
   ```
   Name: ai-learning-platform-db
   Database: ai_learning
   User: ai_user
   ```
3. ä½œæˆå¾Œã€æ¥ç¶šURLã‚’Backendã®ç’°å¢ƒå¤‰æ•°ã«è¨­å®š

#### 4. Static Siteã®ä½œæˆï¼ˆFrontendï¼‰
1. Dashboard â†’ "New" â†’ "Static Site"
2. GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’é¸æŠ
3. è¨­å®šé …ç›®ï¼š
   ```
   Name: ai-learning-platform-frontend
   Build Command: cd frontend && npm install && npm run build
   Publish Directory: frontend/build
   ```

#### 5. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
Frontendç”¨ã®ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.env.production`ï¼‰ã‚’ä½œæˆï¼š
```env
REACT_APP_API_URL=https://your-backend-url.onrender.com/api/v1
```

### Renderå±•é–‹æ™‚ã®æ³¨æ„äº‹é …

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®šã®å¤‰æ›´
Renderã§ã¯ PostgreSQL ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®å¤‰æ›´ãŒå¿…è¦ï¼š

**requirements.txt ã«è¿½åŠ :**
```txt
psycopg2-binary==2.9.7
```

**DATABASE_URL ã®å½¢å¼:**
```
postgresql://username:password@hostname:port/database
```

#### ç„¡æ–™ãƒ—ãƒ©ãƒ³ã®åˆ¶é™
- **ã‚¹ãƒªãƒ¼ãƒ—æ©Ÿèƒ½**: 15åˆ†é–“ã‚¢ã‚¯ã‚»ã‚¹ãŒãªã„ã¨ã‚¹ãƒªãƒ¼ãƒ—çŠ¶æ…‹ã«ãªã‚‹
- **ãƒ“ãƒ«ãƒ‰æ™‚é–“**: æœˆ500åˆ†ã¾ã§
- **å¸¯åŸŸå¹…**: æœˆ100GBã¾ã§
- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: 1GBã¾ã§

## ğŸ”’ æœ¬ç•ªç’°å¢ƒã§ã®è€ƒæ…®äº‹é …

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
- å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä½¿ç”¨
- ç’°å¢ƒå¤‰æ•°ã§ã®æ©Ÿå¯†æƒ…å ±ç®¡ç†
- HTTPSã®è¨­å®šï¼ˆRenderã§è‡ªå‹•æä¾›ï¼‰
- ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã®è¨­å®š

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- ãƒªã‚½ãƒ¼ã‚¹åˆ¶é™ã®è¨­å®š
- ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®å®Ÿè£…
- ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®š

### é«˜å¯ç”¨æ€§
- è¤‡æ•°ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å±•é–‹
- ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã®è¨­å®š
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ä»¥ä¸‹ã®æƒ…å ±ã‚’å«ã‚ã¦ãŠå•ã„åˆã‚ã›ãã ã•ã„ï¼š

1. `docker compose ps` ã®å‡ºåŠ›
2. `docker compose logs` ã®å‡ºåŠ›
3. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è©³ç´°
4. å®Ÿè¡Œç’°å¢ƒã®æƒ…å ±ï¼ˆOSã€Dockerãƒãƒ¼ã‚¸ãƒ§ãƒ³ãªã©ï¼‰

---

**æ³¨æ„**: ã“ã®Dockerè¨­å®šã¯é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒå‘ã‘ã§ã™ã€‚æœ¬ç•ªç’°å¢ƒã§ã¯è¿½åŠ ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šãŒå¿…è¦ã§ã™ã€‚
